<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="resume">
    <select id="selectResume" parameterType="int" resultType="Resume">
        SELECT id, user_id, position_id, created_at, updated_at, title, resume_col, resume_row
        FROM resume
        WHERE user_id = #{userId};
    </select>

    <select id="selectPosition" parameterType="int" resultType="Position">
        SELECT id, recruit_id, title, division
        FROM position
        WHERE id = #{positionId};
    </select>

    <select id="selectEndDate" parameterType="int" resultType="String">
        SELECT end_time FROM recruit WHERE id = #{recruitId};
    </select>

    <insert id="insertResume" useGeneratedKeys="true" keyProperty="id" parameterType="Resume">
        INSERT INTO resume(`user_id`, `position_id`, `title`)
        VALUES (#{userId}, #{positionId}, #{title});
    </insert>

    <insert id="insertAnswer" useGeneratedKeys="true" keyProperty="id" parameterType="Answer">
        INSERT INTO answer(`resume_id`, `order_num`, `question_content`, `answer_content`)
        VALUES (#{resumeId}, #{orderNum}, #{questionContent}, #{answerContent});
    </insert>

    <update id="updateAnswer" parameterType="Answer">
        UPDATE answer
        SET question_content = #{questionContent}, answer_content = #{answerContent}, order_num = #{orderNum}
        WHERE id = #{id}
    </update>

    <update id="updateTitle" parameterType="map">
        UPDATE resume
        SET title = #{title}, updated_at = #{date}
        WHERE id = #{id}
    </update>
</mapper>